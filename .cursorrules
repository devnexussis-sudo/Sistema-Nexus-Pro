# ğŸ›¡ï¸ Nexus Pro - GovernanÃ§a e Diretrizes de Engenharia (Big Tech Standard)

Este documento estabelece os padrÃµes de rigor tÃ©cnico e arquitetura para o projeto **Nexus Pro**. Qualquer modificaÃ§Ã£o no cÃ³digo deve aderir estritamente a estas diretrizes.

## ğŸ PrincÃ­pio Fundamental
**Zero TolerÃ¢ncia para Gambiarras.** Este Ã© um projeto de nÃ­vel Big Tech, projetado para escala massiva, seguranÃ§a extrema e manutenibilidade de longo prazo. Bypasses de seguranÃ§a ou "hacks" temporÃ¡rios sÃ£o proibidos.

---

## ğŸ” SeguranÃ§a e Isolamento de Dados
1.  **Prioridade NÃºmero 1:** Isolamento Multitenant via `tenant_id`. 
2.  **RLS (Row Level Security):** O RLS Ã© a Ãºnica fonte da verdade para permissÃµes. Nunca utilize `service_role` no frontend.
3.  **Isolamento de Escrita:** Todas as operaÃ§Ãµes de `INSERT` e `UPDATE` devem ser validadas no nÃ­vel do banco de dados para garantir que os dados pertenÃ§am ao `tenant_id` do usuÃ¡rio autenticado.

---

## ğŸ—ï¸ GestÃ£o de Banco de Dados
1.  **Migrations First:** Todas as alteraÃ§Ãµes de schema, funÃ§Ãµes SQL ou polÃ­ticas de RLS devem ser realizadas atravÃ©s de arquivos de migraÃ§Ã£o (`supabase/migrations/`).
2.  **Tipagem Estrita:** ApÃ³s qualquer alteraÃ§Ã£o no banco, o comando `npm run db:sync` deve ser executado para atualizar `src/types/supabase.ts`.
3.  **Integridade:** O histÃ³rico de migraÃ§Ãµes local deve sempre refletir o estado do banco remoto.

---

## ğŸ’» Stack TÃ©cnica
- **Frontend:** React 19 + Vite + TypeScript.
- **Backend:** Supabase (Auth, DB, Functions).
- **Styling:** TailwindCSS / CSS Moderno.
- **Infra:** GitHub Actions (CI/CD) + Vercel.

---

## ğŸ¨ PadrÃµes de CÃ³digo
- **Clean Architecture:** SeparaÃ§Ã£o clara entre UI (Componentes), LÃ³gica de NegÃ³cio (Services) e Infra (Lib/Supabase).
- **No `any` Types:** O uso de `any` Ã© desencorajado. Utilize os tipos gerados do banco de dados ou interfaces de domÃ­nio.
- **Singleton Supabase:** Utilize apenas a instÃ¢ncia de cliente exportada em `src/lib/supabase.ts` para garantir a persistÃªncia correta da sessÃ£o e locks de concorrÃªncia.

---

## ğŸ¯ Objetivo Atual
**Reparo de Acesso de Escrita (RLS):** Corrigir o bloqueio de operaÃ§Ãµes `INSERT` e `UPDATE` nas tabelas crÃ­ticas (`orders`, `users`, `user_groups`, `technicians`), garantindo que o isolamento entre empresas esteja 100% garantido no nÃ­vel do banco de dados, sem quebrar a funcionalidade de criaÃ§Ã£o de usuÃ¡rios via Edge Functions.
